<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <title>Mapbox Test</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js" integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og==" crossorigin=""></script>

    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script src='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />

    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        
        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>

<body>
    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.2.0/leaflet-omnivore.min.js'></script>

    <div id='map'></div>
    <script src="polyline.js"></script>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiZG1hd2VyIiwiYSI6ImNqYW1wYWl5cTM3ZGEzM3BiNGpodWxvZzQifQ.Ct1wT5beJEMFV1MQm2sIkg';

        L.mapbox.accessToken = 'pk.eyJ1IjoiZG1hd2VyIiwiYSI6ImNqYW1wYWl5cTM3ZGEzM3BiNGpodWxvZzQifQ.Ct1wT5beJEMFV1MQm2sIkg';
                const map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/dmawer/cjsw3mn1o769e1fo66kfvck9u',
                    center: [-73.811, 44.132],
                    zoom: 12.0
                });

        var hikeStyle = {
            "color": "#00ccff",
            "weight": 5,
            "opacity": .8,
        };


        customLayerHike = L.geoJson(null, {
            style: hikeStyle
        }).addTo(map);


        var runLayer = omnivore.gpx('Haystack.gpx', null, customLayerHike)
            .addTo(map);

        //        map.on('load', function() { 
        //        
        //        var hikeLayer = omnivore.gpx('Haystack.gpx', null, customLayerHike).addTo(map); })''

        //        var customLayer = L.geoJson(null, {
        //            // http://leafletjs.com/reference.html#geojson-style
        //            style: function(feature) {
        //                return {
        //                    color: '#f00'
        //                };
        //            }
        //        });
        // this can be any kind of omnivore layer
        //        var runLayer = omnivore.kml('line.kml', null, customLayer)

        //        var hikeLayer = omnivore.gpx('Haystack.gpx', null, customLayer).on('ready', function() {}).addTo(map);
        //        
        //        console.log(hikeLayer);
    </script>



</body>

</html>